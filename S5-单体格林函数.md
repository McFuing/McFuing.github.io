## 单体格林函数简引

### 格林函数的定义

由量子力学我们可以知道，当我们知道一个系统的哈密顿量$H$,那么我们可以求出它的本征值与本征函数，以及其它的物理量。但是求解哈密顿量$H$的本征函数是困难的，那我们试图找到一个包含$H$所包含的信息等价的算符，即格林算符
$$
\begin{equation}
G\left(  z\right)  =\left(  z-H\right)  ^{-1}=\frac{1}{z-H}%
,z\text{为复参量}
\end{equation}
$$
这里的$z$完全可以是$E_{n}$.

对于定态问题，有哈密顿量的本征方程(已知)
$$
\begin{equation}
H\left\vert \varphi_{n}\right\rangle =E_{n}\left\vert \varphi_{n}%
\right\rangle
\end{equation}
$$
且要求本征集正交归一
$$
\begin{equation}
\langle\varphi_{n}\left\vert \varphi_{m}\right\rangle =\delta_{mn}
\end{equation}
$$
完备关系
$$
\begin{equation}
\sum_{n}\left\vert \varphi_{n}\right\rangle \left\langle \varphi
_{n}\right\vert =1
\end{equation}
$$
将式(\ref{1})插入完备恒等式
$$
\begin{align}
G\left(  z\right)   &  =\frac{1}{z-H}\sum_{n}\left\vert \varphi_{n}%
\right\rangle \left\langle \varphi_{n}\right\vert \nonumber\\
&  =\sum_{n}\frac{\left\vert \varphi_{n}\right\rangle \left\langle \varphi
_{n}\right\vert }{z-E_{n}}
\end{align}
$$

>>可以看出$G\left(  z\right)$ 中包含$H$的本征值与本征函数的全部信息,同时当得到$H$的全部本征值与本征函数，$G\left( z \right)$ 也就已知

### 复杂系统的格林函数处理


对于不能严格求解的系统，我们将$H$分成两个部分
$$
\begin{equation}
H=H_{0}+H_{1} 
\end{equation}
$$

相应对于$H_{0}$的格林函数为
$$
G_{0}\left(  z\right)  =\frac{1}{z-H_{0}}
$$
$H$对应的格林函数为
$$
\begin{align}
G\left(  z\right)   &  =\left(  z-H_{0}-H_{1}\right)  ^{-1}\nonumber\\
&  =\left[  \left(  z-H_{0}\right)  \left(  1-\frac{H_{1}}{z-H_{0}}\right)
\right]  ^{-1}\nonumber\\
&  =\left[  \left(  z-H_{0}\right)  \left(  1-G_{0}\left(  z\right)
H_{1}\right)  \right]  ^{-1}\nonumber\\
&  =\left(  1-G_{0}\left(  z\right)  H_{1}\right)  ^{-1}G_{0}\left(  z\right)
\\
&  =G_{0}\left(  z\right)  \left(  1-H_{1}G_{0}\left(  z\right)  \right)
^{-1}%
\end{align}
$$
也即
$$
\begin{align}
\left(  1-G_{0}\left(  z\right)  H_{1}\right)  G\left(  z\right)   &
=G_{0}\left(  z\right) \\
G\left(  z\right)  \left(  1-G_{0}\left(  z\right)  H_{1}\right)   &
=G_{0}\left(  z\right)
\end{align}
$$
可得
$$
\begin{align}
G\left(  z\right)   &  =G_{0}\left(  z\right)  +G_{0}H_{1}G\label{2}\\
G\left(  z\right)   &  =G_{0}\left(  z\right)  +GH_{1}G_{0} \label{3}%
\end{align}
$$
可以看出式(\ref{2})(\ref{3})具有封闭性。

反复迭代[^1]

[^1]:从$G_{0}$与$H_{1}$的对易关系也可以看出

$$
\begin{align}
G\left(  z\right)   &  =G_{0}\left(  z\right)  +GH_{1}G_{0}\nonumber\\
&  =G_{0}\left(  z\right)  +\left(  G_{0}\left(  z\right)  +GH_{1}%
G_{0}\right)  H_{1}G_{0}\nonumber\\
&  =G_{0}\left(  z\right)  +G_{0}\left(  z\right)  H_{1}G_{0}+G\left(
H_{1}G_{0}\right)  ^{2}\nonumber\\
&  =...\nonumber\\
&  =G_{0}\left(  z\right)  +G_{0}\left(  z\right)  H_{1}G_{0}+G_{0}\left(
H_{1}G_{0}\right)  ^{2}+...+G\left(  H_{1}G_{0}\right)  ^{m}\nonumber\\
&  =G_{0}\sum_{n=0}^{\infty}\left(  H_{1}G_{0}\right)  ^{n}=\sum_{n=0}%
^{\infty}\left(  G_{0}H_{1}\right)  ^{n}G_{0}
\end{align}
$$


我们定义一个新的算符$T$
$$
\begin{equation}
G=G_{0}+G_{0}TG_{0}%
\end{equation}
$$
与式(\ref{2})(\ref{3})比较可得
$$
\begin{align}
TG_{0} &  =H_{1}G\\
G_{0}T &  =GH_{1}%
\end{align}
$$
其中
$$
\begin{align}
T &  =H_{1}\sum_{n=0}^{\infty}\left(  G_{0}H_{1}\right)  ^{n}=H_{1}\left(
1+GH_{1}\right)  \nonumber\\
&  =H_{1}+H_{1}GH_{1}\\
&  =H_{1}+TG_{0}H_{1}=H_{1}+H_{1}G_{0}T
\end{align}
$$
对于式(\ref{4}),可以得到$H_{0},H$
的本征方程
$$
\begin{equation}
H_{0}\left\vert \varphi_{n}\right\rangle =E_{n}\left\vert \varphi
_{n}\right\rangle 
\end{equation}
$$
$$
\begin{equation}
H\left\vert \psi\right\rangle =E\left\vert \psi\right\rangle 
\end{equation}
$$
我们可以从$H_{0}$的本征函数$\left\vert \varphi_{n}\right\rangle$以及$G_{0}$求得$H$的本征函数$\left\vert \psi\right\rangle$，所以
$$
\begin{equation}
\left(  E_{n}-H_{0}\right)  \left\vert \varphi_{n}\right\rangle =G_{0}%
^{-1}\left(  E_{n}\right)  \left\vert \varphi_{n}\right\rangle =0
\end{equation}
$$
$$
\begin{equation}
\left(  E-H_{0}\right)  \left\vert \psi\right\rangle =G_{0}^{-1}\left(
E\right)  \left\vert \psi\right\rangle =H_{1}\left\vert \psi\right\rangle
\end{equation}
$$
当$E\neq E_{n}$时，由式(\ref{8})可得
$$
\begin{equation}
\left\vert \psi\right\rangle =G_{0}\left(  E\right)  H_{1}\left\vert
\psi\right\rangle
\end{equation}
$$
当$E=E_{n}$时，由式(\ref{7})(\ref{8)可得，$G_{0}^{-1}\left(  E_{n}\right)  \left\vert \psi\right\rangle -G_{0}^{-1}\left(  E_{n}\right)  \left\vert \varphi_{n}\right\rangle =H_{1}\left\vert \psi\right\rangle$
$$
\begin{equation}
\left\vert \psi\right\rangle =\left\vert \varphi_{n}\right\rangle
+G_{0}\left(  E_{n}\right)  H_{1}\left\vert \psi\right\rangle 
\end{equation}
$$
迭代可得
$$
\begin{align}
\left\vert \psi\right\rangle  &  =\left\vert \varphi_{n}\right\rangle
+G_{0}\left(  E_{n}\right)  H_{1}\left(  \left\vert \varphi_{n}\right\rangle
+G_{0}\left(  E_{n}\right)  H_{1}\left\vert \psi\right\rangle \right)
\nonumber\\
&  =\left\vert \varphi_{n}\right\rangle +G_{0}\left(  E_{n}\right)
H_{1}\left\vert \varphi_{n}\right\rangle +\left(  G_{0}\left(  E_{n}\right)
H_{1}\right)  ^{2}\left\vert \psi\right\rangle \nonumber\\
&  =\left\vert \varphi_{n}\right\rangle +G_{0}\left(  E_{n}\right)
H_{1}\left\vert \varphi_{n}\right\rangle +\left(  G_{0}\left(  E_{n}\right)
H_{1}\right)  ^{2}\left(  \left\vert \varphi_{n}\right\rangle +G_{0}\left(
E_{n}\right)  H_{1}\left\vert \psi\right\rangle \right)  \nonumber\\
&  =\left\vert \varphi_{n}\right\rangle +G_{0}\left(  E_{n}\right)
H_{1}\left\vert \varphi_{n}\right\rangle +\left(  G_{0}\left(  E_{n}\right)
H_{1}\right)  ^{2}\left\vert \varphi_{n}\right\rangle +\left(  G_{0}\left(
E_{n}\right)  H_{1}\right)  ^{3}\left\vert \psi\right\rangle \nonumber\\
&  =\sum_{i=0}^{\infty}\left(  G_{0}\left(  E_{n}\right)  H_{1}\right)
^{i}\left\vert \varphi_{n}\right\rangle \nonumber\\
&  =\left(  1+GH_{1}\right)  \left\vert \varphi_{n}\right\rangle =\left(
1+G_{0}T\right)  \left\vert \varphi_{n}\right\rangle \nonumber\\
&  =\left\vert \varphi_{n}\right\rangle +G_{0}\left(  E_{n}\right)  T\left(
E_{n}\right)  \left\vert \varphi_{n}\right\rangle
\end{align}
$$
即有
$$
\begin{equation}
T\left(  E_{n}\right)  \left\vert \varphi_{n}\right\rangle =H_{1}\left\vert
\psi\right\rangle
\end{equation}
$$

### 格林函数相关的物理量


由于格林函数与哈密顿量一样，含有系统的所有信息，因此凡是通过哈密顿量能够计算出来的物理量，从格林函数也可以求出。比如我们计算态密度[^2]
$$
\begin{equation}
\rho\left(  E\right)  =\sum_{n}\delta\left(  E-E_{n}\right)
\end{equation}
$$
[^2]:求和是对态求和，相当于求$E=E_{n}$的态有多少个，即简并度

整个能量的积分
$$
\begin{equation}
\int_{-\infty}^{+\infty}\rho\left(  E\right)  dE=\sum_{n}%
\end{equation}
$$
计算态密度时会用到以下的恒等式$$
\lim_{\eta\rightarrow0^{+}}\frac{1}{x\pm i\eta}=P\frac{1}{x}\mp i\pi
\delta\left(  x\right)
$$
求态密度的动机：
$$
\begin{aligned}
1.&系统的热力学量需要态密度；跃迁几率，跃迁振幅......\\
2.&态密度较易观测
\end{aligned}
$$
## 在具体表象的表示

### 坐标表象

#### 格林函数表达

对式(\ref{1})取坐标表象的矩阵元
$$
\begin{equation}
\left\langle \mathbf{r}\right\vert \left(  z-H\right)  G\left(  z\right)
\left\vert \mathbf{r}\right\rangle =\left\langle \mathbf{r}\right\vert
\mathbf{r\rangle}
\end{equation}
$$
已知
$$
\begin{equation}
\left\langle \mathbf{r}\right\vert \mathbf{r}^{\prime}\mathbf{\rangle=\delta
}\left(  \mathbf{r-r}^{\prime}\right)
\end{equation}
$$
完备关系
$$
\begin{equation}
\int d\mathbf{r}\left\vert \mathbf{r}\right\rangle \left\langle \mathbf{r}%
\right\vert =1
\end{equation}
$$
将式(\ref{9})化为
$$
\begin{equation}
\int d\mathbf{r}^{\prime\prime}\left\langle \mathbf{r}\right\vert \left(
z-H\right)  \left\vert \mathbf{r}^{\prime\prime}\right\rangle \left\langle
\mathbf{r}^{\prime\prime}\right\vert G\left(  z\right)  \left\vert
\mathbf{r}^{\prime}\right\rangle =\mathbf{\delta}\left(  \mathbf{r-r}^{\prime
}\right)
\end{equation}
$$
记
$$\begin{equation}
\left\langle \mathbf{r}^{\prime\prime}\right\vert G\left(  z\right)
\left\vert \mathbf{r}^{\prime}\right\rangle =G\left(  \mathbf{r}^{\prime
\prime},\mathbf{r}^{\prime};z\right)
\end{equation}
$$
为格林算符在坐标表象下的矩阵元，同理对于哈密顿量
$$
\begin{equation}
\left\langle \mathbf{r}\right\vert H\left\vert \mathbf{r}^{\prime
}\right\rangle =H\left(  \mathbf{r},\mathbf{r}^{\prime}\right)  \label{10}%
\end{equation}
$$
哈密顿量是单体算符因此式(\ref{10})可以表示为
$$
\begin{equation}
H\left(  \mathbf{r},\mathbf{r}^{\prime}\right)  =H\left(  \mathbf{r}\right)
\mathbf{\delta}\left(  \mathbf{r-r}^{\prime}\right)
\footnote{Q：对所有的单体算符都成立吗？}%
\end{equation}
因此$H$%
的本征方程及式(\ref{11}%
)可化为\begin{align}
\int\left\langle \mathbf{r}\right\vert H\left\vert \mathbf{r}^{\prime
}\right\rangle \langle\mathbf{r}^{\prime}\left\vert \varphi_{n}\right\rangle
d\mathbf{r}^{\prime}  & =E_{n}\varphi_{n}\left(  \mathbf{r}\right)
\nonumber\\
\int H\left(  \mathbf{r}\right)  \mathbf{\delta}\left(  \mathbf{r-r}^{\prime
}\right)  \langle\mathbf{r}^{\prime}\left\vert \varphi_{n}\right\rangle
d\mathbf{r}^{\prime}  & =E_{n}\varphi_{n}\left(  \mathbf{r}\right)
\nonumber\\
H\left(  \mathbf{r}\right)  \varphi_{n}\left(  \mathbf{r}\right)    &
=E_{n}\varphi_{n}\left(  \mathbf{r}\right)
\end{align}%
\begin{equation}
\left[  z-H\left(  \mathbf{r}\right)  \right]  G\left(  \mathbf{r}%
,\mathbf{r}^{\prime};z\right)  =\mathbf{\delta}\left(  \mathbf{r-r}^{\prime
}\right)  \label{13}%
\end{equation}
式(\ref{12})可以表示为\begin{align}
G\left(  \mathbf{r},\mathbf{r}^{\prime};z\right)    & =\left\langle
\mathbf{r}\right\vert \sum_{n}\frac{\left\vert \varphi_{n}\right\rangle
\left\langle \varphi_{n}\right\vert }{z-E_{n}}\left\vert \mathbf{r}^{\prime
}\right\rangle \nonumber\\
& =\sum_{n}\frac{\varphi_{n}\left(  \mathbf{r}\right)  \varphi_{n}^{\ast
}\left(  \mathbf{r}^{\prime}\right)  }{z-E_{n}}\label{14}%
\end{align}
同时取共轭可得\begin{equation}
G^{\ast}\left(  \mathbf{r},\mathbf{r}^{\prime};z\right)  =G\left(
\mathbf{r}^{\prime},\mathbf{r};z^{\ast}\right)
\end{equation}


\begin{conclusion3}
如果我们可以以一种方式计算出格林函数，那么它的一阶极点处就是能量本征值
\end{conclusion3}

在坐标表象中求解格林函数：

\begin{enumerate}
\item
由格林函数的本征方程(\ref{13}%
)出发，结合边界条件得到格林函数

\item
由格林函数的定义(\ref{14}%
)出发,求出$H$的本征值与本征函数得到格林函数
\end{enumerate}

对于式(\ref{14})的求和是对分立谱求和以及连续谱积分。

其中连续谱，我们可以定义从上半平面或者下半平面无限趋于实轴的侧极限\footnote{不懂}%
：\begin{equation}
G^{\pm}\left(  \mathbf{r},\mathbf{r}^{\prime};E\right)  =G\left(
\mathbf{r},\mathbf{r}^{\prime};E\pm i0^{+}\right)  =\sum_{n}\frac{\varphi
_{n}\left(  \mathbf{r}\right)  \varphi_{n}^{\ast}\left(  \mathbf{r}^{\prime
}\right)  }{E\pm i0^{+}-E_{n}}\label{17}%
\end{equation}
式(\ref{2}%
)在坐标表象下的表示为\begin{equation}
\left\langle \mathbf{r}\right\vert G\left(  z\right)  \left\vert
\mathbf{r}^{\prime}\right\rangle =\left\langle \mathbf{r}\right\vert
G_{0}\left(  z\right)  \left\vert \mathbf{r}^{\prime}\right\rangle
+\left\langle \mathbf{r}\right\vert G_{0}H_{1}G\left\vert \mathbf{r}^{\prime
}\right\rangle
\end{equation}
即\begin{equation}
G\left(  \mathbf{r},\mathbf{r}^{\prime};z\right)  =G_{0}\left(  \mathbf{r}%
,\mathbf{r}^{\prime};z\right)  +\int d\mathbf{r}_{1}d\mathbf{r}_{2}%
G_{0}\left(  \mathbf{r},\mathbf{r}_{1};z\right)  H_{1}\left(  \mathbf{r}%
_{1},\mathbf{r}_{2}\right)  G\left(  \mathbf{r}_{2},\mathbf{r}^{\prime
};z\right)  \label{15}%
\end{equation}
其中$H_{1}$%
是单体格林算符\begin{equation}
H_{1}\left(  \mathbf{r}_{1},\mathbf{r}_{2}\right)  =\left\langle
\mathbf{r}_{1}\right\vert H_{1}\left\vert \mathbf{r}_{2}\right\rangle
=V\left(  \mathbf{r}_{1}\right)  \mathbf{\delta}\left(  \mathbf{r}%
_{1}\mathbf{-r}_{2}\right)
\end{equation}
格林函数(\ref{15})可以写为\begin{align*}
G\left(  \mathbf{r},\mathbf{r}^{\prime};z\right)    & =G_{0}\left(
\mathbf{r},\mathbf{r}^{\prime};z\right)  +\int d\mathbf{r}_{1}d\mathbf{r}%
_{2}G_{0}\left(  \mathbf{r},\mathbf{r}_{1};z\right)  V\left(  \mathbf{r}%
\right)  \mathbf{\delta}\left(  \mathbf{r}_{1}\mathbf{-r}_{2}\right)  G\left(
\mathbf{r}_{2},\mathbf{r}^{\prime};z\right)  \\
& =G_{0}\left(  \mathbf{r},\mathbf{r}^{\prime};z\right)  +\int d\mathbf{r}%
_{1}G_{0}\left(  \mathbf{r},\mathbf{r}_{1};z\right)  V\left(  \mathbf{r}%
_{1}\right)  G\left(  \mathbf{r}_{1},\mathbf{r}^{\prime};z\right)
\end{align*}


\subsubsection{波函数的表达}

由完备关系，将式(\ref{20}%
)(\ref{21})改写为\begin{equation}
\psi\left(  \mathbf{r}\right)  =\varphi_{n}\left(  r\right)  +\int
d\mathbf{r}_{1}d\mathbf{r}_{2}G_{0}\left(  \mathbf{r},\mathbf{r}_{1}%
;E_{n}\right)  H_{1}\left(  \mathbf{r}_{1},\mathbf{r}_{2}\right)  \psi\left(
\mathbf{r}_{2}\right)
\end{equation}%
\begin{equation}
\psi\left(  \mathbf{r}\right)  =\varphi_{n}\left(  \mathbf{r}\right)  +\int
d\mathbf{r}_{1}d\mathbf{r}_{2}G_{0}\left(  \mathbf{r,r}_{1};E_{n}\right)
T\left(  \mathbf{r}_{1}\mathbf{,r}_{2}\mathbf{;}E_{n}\right)  \varphi
_{n}\left(  \mathbf{r}_{2}\right)
\end{equation}
当能级处于连续谱，只能使用侧极限\begin{equation}
\psi^{\pm}\left(  \mathbf{r}\right)  =\varphi_{n}\left(  r\right)  +\int
d\mathbf{r}_{1}d\mathbf{r}_{2}G_{0}^{\pm}\left(  \mathbf{r},\mathbf{r}%
_{1};E_{n}\right)  H_{1}\left(  \mathbf{r}_{1},\mathbf{r}_{2}\right)
\psi^{\pm}\left(  \mathbf{r}_{2}\right)
\end{equation}%
\begin{equation}
\psi^{\pm}\left(  \mathbf{r}\right)  =\varphi_{n}\left(  \mathbf{r}\right)
+\int d\mathbf{r}_{1}d\mathbf{r}_{2}G_{0}^{\pm}\left(  \mathbf{r,r}_{1}%
;E_{n}\right)  T^{\pm}\left(  \mathbf{r}_{1}\mathbf{,r}_{2}\mathbf{;}%
E_{n}\right)  \varphi_{n}\left(  \mathbf{r}_{2}\right)
\footnote{$T^{\pm}$哪里来的？}%
\end{equation}
用于求能级为$H_{0}$的连续谱的波函数。

\subsubsection{态密度}

态密度，单位能量间隔内的状态数目\footnote{态密度是相对连续能谱的}%
。

由态密度的定义(\ref{16}%
)可得\begin{align}
\rho\left(  E\right)    & =\sum_{n}\delta\left(  E-E_{n}\right)
\mathbf{1}\nonumber\\
& =\sum_{n}\delta\left(  E-E_{n}\right)  \int_{V}\sum_{m}\varphi_{m}\left(
\mathbf{r}\right)  \varphi_{m}^{\ast}\left(  \mathbf{r}^{\prime}\right)
d\mathbf{r}^{\prime}\nonumber\\
& =\int_{V}\sum_{n}\delta\left(  E-E_{n}\right)  \varphi_{n}\left(
\mathbf{r}\right)  \varphi_{n}^{\ast}\left(  \mathbf{r}^{\prime}\right)
d\mathbf{r}^{\prime}\\
& =\int_{V}\rho\left(  \mathbf{r};E\right)  d\mathbf{r}%
\end{align}
其中\begin{equation}
\rho\left(  \mathbf{r};E\right)  =\sum_{n}\delta\left(  E-E_{n}\right)
\varphi_{n}\left(  \mathbf{r}\right)  \varphi_{n}^{\ast}\left(  \mathbf{r}%
^{\prime}\right)  \label{18}%
\end{equation}
我们要用格林函数来表示态密度,对式(\ref{17}%
)取对角元可知\begin{align}
G^{\pm}\left(  \mathbf{r},\mathbf{r};E\right)    & =G\left(  \mathbf{r}%
,\mathbf{r};E\pm i0^{+}\right)  =\sum_{n}\frac{\varphi_{n}\left(
\mathbf{r}\right)  \varphi_{n}^{\ast}\left(  \mathbf{r}\right)  }{E\pm
i0^{+}-E_{n}}\nonumber\\
& =\sum_{n}\varphi_{n}\left(  \mathbf{r}\right)  \varphi_{n}^{\ast}\left(
\mathbf{r}\right)  \left[  P\frac{1}{E-E_{n}}\mp i\pi\delta\left(
E-E_{n}\right)  \right]
\end{align}
与式(\ref{18})对照\begin{equation}
\rho\left(  \mathbf{r};E\right)  =\mp\frac{1}{\pi}\operatorname{Im}G^{\pm
}\left(  \mathbf{r},\mathbf{r};E\right)  \text{\footnote{$G^{+}$%
与$G^{-}$互为共轭;$\rho\left(  \mathbf{r}%
,E\right)  $称为局域态密度}%
}\label{19}%
\end{equation}
对全空间积分可得\begin{equation}
\rho\left(  E\right)  =\mp\frac{1}{\pi}\int d\mathbf{r}\operatorname{Im}%
G^{\pm}\left(  \mathbf{r},\mathbf{r};E\right)
\end{equation}

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTIzNTkwOTA4MSw2NzI1NjY2NDJdfQ==
-->